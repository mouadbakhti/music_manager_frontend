<div *ngIf="successMessage" class="alert alert-success">
    {{ successMessage }}
</div>
<div class="track-grid">
    <div class="track-card" *ngFor="let track of tracks">
        <div class="cover" *ngIf="track.coverUrl">
            <img [src]="track.coverUrl" alt="{{ track.title }}">
        </div>
        <div class="info">
            <h5>{{ track.title }}</h5>
            <p>{{ track.artist }}</p>
            <span>{{ track.duration }}s</span>
        </div>
        <div class="d-flex gap-2 mt-2">
            <button type="button" (click)="openEditModal(track)" class="btn btn-sm btn-secondary">Edit</button>
            <button (click)="openDeleteModal(track)" class="btn btn-danger">Delete</button>
        </div>
    </div>
</div>

<!-- Modal OUTSIDE the *ngFor -->
<div *ngIf="isModalOpen" class="modal">
    <form (ngSubmit)="updateTrack(editingTrack.id)">
        <div class="modal-field">
            <label for="title" class="form-label">Song</label>
            <input id="title" [(ngModel)]="editingTrack.title" name="title" placeholder="Title">
        </div>
        <div class="modal-field">
            <label for="artist" class="form-label">Artist</label>
            <input id="artist" [(ngModel)]="editingTrack.artist" name="artist" placeholder="Artist">
        </div>
        <div class="modal-actions">
            <button type="submit">Save</button>
            <button type="button" (click)="closeModal()">Cancel</button>
        </div>
    </form>
</div>

<div class="modal confirmation-modal" *ngIf="showDeleteModal">
  <div class="modal-content">
    <p>Are you sure you want to delete "{{ trackToDelete?.title }}"?</p>
    <button (click)="confirmDelete()">Yes, Delete</button>
    <button (click)="cancelDelete()">Cancel</button>
  </div>
</div>